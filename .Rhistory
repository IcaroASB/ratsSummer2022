capture_recapture_the_bronx <- function(year) {
lots_year_1 <- df_The_Bronx %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_The_Bronx %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_The_Bronx_Num_Rats <- sapply(2011:2021, capture_recapture_the_bronx)
df_The_Bronx_Num_Rats <- as.data.frame(df_The_Bronx_Num_Rats)
df_The_Bronx_Num_Rats <- df_The_Bronx_Num_Rats %>%
add_column(Borough = "BRONX",
.after = "df_The_Bronx_Num_Rats")
df_The_Bronx_Num_Rats <- df_The_Bronx_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_The_Bronx_Num_Rats <- rename(df_The_Bronx_Num_Rats, numRats = df_The_Bronx_Num_Rats)
capture_recapture_brooklyn <- function(year) {
lots_year_1 <- df_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Brooklyn_Num_Rats <- sapply(2011:2021, capture_recapture_brooklyn)
df_Brooklyn_Num_Rats <- as.data.frame(df_Brooklyn_Num_Rats)
df_Brooklyn_Num_Rats <- df_Brooklyn_Num_Rats %>%
add_column(Borough = "BROOKLYN",
.after = "df_Brooklyn_Num_Rats")
df_Brooklyn_Num_Rats <- df_Brooklyn_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Brooklyn_Num_Rats <- rename(df_Brooklyn_Num_Rats, numRats = df_Brooklyn_Num_Rats)
capture_recapture_manhattan <- function(year) {
lots_year_1 <- df_Manhattan %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Manhattan %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Manhattan_Num_Rats <- sapply(2011:2021, capture_recapture_manhattan)
df_Manhattan_Num_Rats <- as.data.frame(df_Manhattan_Num_Rats)
df_Manhattan_Num_Rats <- df_Manhattan_Num_Rats %>%
add_column(Borough = "MANHATTAN",
.after = "df_Manhattan_Num_Rats")
df_Manhattan_Num_Rats <- df_Manhattan_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Manhattan_Num_Rats <- rename(df_Manhattan_Num_Rats, numRats = df_Manhattan_Num_Rats)
capture_recapture_queens <- function(year) {
lots_year_1 <- df_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Queens_Num_Rats <- sapply(2011:2021, capture_recapture_queens)
df_Queens_Num_Rats <- as.data.frame(df_Queens_Num_Rats)
df_Queens_Num_Rats <- df_Queens_Num_Rats %>%
add_column(Borough = "QUEENS",
.after = "df_Queens_Num_Rats")
df_Queens_Num_Rats <- df_Queens_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Queens_Num_Rats <- rename(df_Queens_Num_Rats, numRats = df_Queens_Num_Rats)
capture_recapture_staten_island <- function(year) {
lots_year_1 <- df_Staten_Island %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Staten_Island %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Staten_Island_Num_Rats <- sapply(2011:2021, capture_recapture_staten_island) #turns to a list of 7
df_Staten_Island_Num_Rats <- as.data.frame(df_Staten_Island_Num_Rats)
df_Staten_Island_Num_Rats <- df_Staten_Island_Num_Rats %>%  #adding in Borough manually
add_column(Borough = "STATEN ISLAND",
.after = "df_Staten_Island_Num_Rats")
df_Staten_Island_Num_Rats <- df_Staten_Island_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Staten_Island_Num_Rats <- rename(df_Staten_Island_Num_Rats, numRats = df_Staten_Island_Num_Rats)
# capture_recapture_nyc <- function(year) {
#   lots_year_1 <- df_NYC %>% filter(Year == year - 1) %>% pull(BBL)
#   lots_year_2 <- df_NYC %>% filter(Year == year) %>% pull(BBL)
#   number_in_year_1 <- length(lots_year_1)
#   number_in_year_2 <- length(lots_year_2)
#   number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#   50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# }
#
# df_NYC_Num_Rats <- sapply(11:21, capture_recapture_nyc)
# df_NYC_Num_Rats <- as.data.frame(df_NYC_Num_Rats)
#
# df_NYC_Num_Rats <- df_NYC_Num_Rats %>%
#   add_column(Group = "NYC",
#              .after = "df_NYC_Num_Rats")
#
# df_NYC_Num_Rats <- df_NYC_Num_Rats %>%
#   add_column(Year = 11:21,
#              .after = "Group")
#
# df_NYC_Num_Rats <- rename(df_NYC_Num_Rats, numRats = df_NYC_Num_Rats)
options(scipen = 999)
df_NYC_Num_Rats <- list( df_Brooklyn_Num_Rats, df_Queens_Num_Rats,  df_Manhattan_Num_Rats, df_The_Bronx_Num_Rats, df_Staten_Island_Num_Rats)
df_NYC_Num_Rats <- Reduce(function(x,y) merge(x,y, all = TRUE), df_NYC_Num_Rats)
df_NYC_Num_Rats <- df_NYC_Num_Rats[order(df_NYC_Num_Rats$numRats),]
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1.png", height = 2400, width = 3840, units = "px")
graph2.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text())
ggsave("graph2.png", height = 2400, width = 3840, units = "px")
graph1.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Do Rats Proliferate Faster in Certain Boroughs?", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
# animate(graph1.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
# anim_save("graph1anim.gif")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
# animate(graph2.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
# anim_save("graph2anim.gif")
capture_recapture_the_bronx_n1 <- function(year) {
lots_year_1 <- df_Central_Bronx %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Bronx %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Bronx <- sapply(2011:2021, capture_recapture_the_bronx_n1)
df_Central_Bronx <- as.data.frame(df_Central_Bronx)
df_Central_Bronx <- df_Central_Bronx %>%
add_column(Neighborhood = "CENTRAL BRONX",
.after = "df_Central_Bronx")
df_Central_Bronx <- df_Central_Bronx %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Bronx <- rename(df_Central_Bronx, numRats = df_Central_Bronx)
capture_recapture_the_bronx_n2 <- function(year) {
lots_year_1 <- df_Bronx_Park_Fordham %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Bronx_Park_Fordham %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Bronx_Park_Fordham <- sapply(2011:2021, capture_recapture_the_bronx_n2)
df_Bronx_Park_Fordham <- as.data.frame(df_Bronx_Park_Fordham)
df_Bronx_Park_Fordham <- df_Bronx_Park_Fordham %>%
add_column(Neighborhood = "BRONX PARK AND FORDHAM",
.after = "df_Bronx_Park_Fordham")
df_Bronx_Park_Fordham <- df_Bronx_Park_Fordham %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Bronx_Park_Fordham <- rename(df_Bronx_Park_Fordham, numRats = df_Bronx_Park_Fordham)
capture_recapture_the_bronx_n3 <- function(year) {
lots_year_1 <- df_High_Bridge_Morrisania %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_High_Bridge_Morrisania %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_High_Bridge_Morrisania <- sapply(2011:2021, capture_recapture_the_bronx_n3)
df_High_Bridge_Morrisania <- as.data.frame(df_High_Bridge_Morrisania)
df_High_Bridge_Morrisania <- df_High_Bridge_Morrisania %>%
add_column(Neighborhood = "HIGH BRIDGE AND MORRISANIA",
.after = "df_High_Bridge_Morrisania")
df_High_Bridge_Morrisania <- df_High_Bridge_Morrisania %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_High_Bridge_Morrisania <- rename(df_High_Bridge_Morrisania, numRats = df_High_Bridge_Morrisania)
capture_recapture_the_bronx_n4 <- function(year) {
lots_year_1 <- df_Hunts_Point_Mott_Haven %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Hunts_Point_Mott_Haven %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Hunts_Point_Mott_Haven <- sapply(2011:2021, capture_recapture_the_bronx_n4)
df_Hunts_Point_Mott_Haven <- as.data.frame(df_Hunts_Point_Mott_Haven)
df_Hunts_Point_Mott_Haven <- df_Hunts_Point_Mott_Haven %>%
add_column(Neighborhood = "HUNTS POINT AND MOTT HAVEN",
.after = "df_Hunts_Point_Mott_Haven")
df_Hunts_Point_Mott_Haven <- df_Hunts_Point_Mott_Haven %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Hunts_Point_Mott_Haven <- rename(df_Hunts_Point_Mott_Haven, numRats = df_Hunts_Point_Mott_Haven)
capture_recapture_the_bronx_n5 <- function(year) {
lots_year_1 <- df_Kingsbridge_Riverdale %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Kingsbridge_Riverdale %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Kingsbridge_Riverdale <- sapply(2011:2021, capture_recapture_the_bronx_n5)
df_Kingsbridge_Riverdale <- as.data.frame(df_Kingsbridge_Riverdale)
df_Kingsbridge_Riverdale <- df_Kingsbridge_Riverdale %>%
add_column(Neighborhood = "KINGSBRIDGE AND RIVERDALE",
.after = "df_Kingsbridge_Riverdale")
df_Kingsbridge_Riverdale <- df_Kingsbridge_Riverdale %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Kingsbridge_Riverdale <- rename(df_Kingsbridge_Riverdale, numRats = df_Kingsbridge_Riverdale)
capture_recapture_the_bronx_n6 <- function(year) {
lots_year_1 <- df_Northeast_Bronx %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northeast_Bronx %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northeast_Bronx <- sapply(2011:2021, capture_recapture_the_bronx_n6)
df_Northeast_Bronx <- as.data.frame(df_Northeast_Bronx)
df_Northeast_Bronx <- df_Northeast_Bronx %>%
add_column(Neighborhood = "NORTHEAST BRONX",
.after = "df_Northeast_Bronx")
df_Northeast_Bronx <- df_Northeast_Bronx %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northeast_Bronx <- rename(df_Northeast_Bronx, numRats = df_Northeast_Bronx)
capture_recapture_the_bronx_n7 <- function(year) {
lots_year_1 <- df_Southeast_Bronx %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southeast_Bronx %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southeast_Bronx <- sapply(2011:2021, capture_recapture_the_bronx_n7)
df_Southeast_Bronx <- as.data.frame(df_Southeast_Bronx)
df_Southeast_Bronx <- df_Southeast_Bronx %>%
add_column(Neighborhood = "SOUTHEAST BRONX",
.after = "df_Southeast_Bronx")
df_Southeast_Bronx <- df_Southeast_Bronx %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southeast_Bronx <- rename(df_Southeast_Bronx, numRats = df_Southeast_Bronx)
df_The_Bronx_Neighborhood_Rats <- rbind(df_Central_Bronx, df_Bronx_Park_Fordham, df_High_Bridge_Morrisania, df_Hunts_Point_Mott_Haven, df_Kingsbridge_Riverdale, df_Northeast_Bronx, df_Southeast_Bronx)
rm(df_Central_Bronx, df_Bronx_Park_Fordham, df_High_Bridge_Morrisania, df_Hunts_Point_Mott_Haven, df_Kingsbridge_Riverdale, df_Northeast_Bronx, df_Southeast_Bronx)
graphBronxTotal.static <- ggplot(df_The_Bronx_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,250000, by = 25000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphBronxTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_brooklyn_n1 <- function(year) {
lots_year_1 <- df_Central_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n1)
df_Central_Brooklyn <- as.data.frame(df_Central_Brooklyn)
df_Central_Brooklyn <- df_Central_Brooklyn %>%
add_column(Neighborhood = "CENTRAL BROOKLYN",
.after = "df_Central_Brooklyn")
df_Central_Brooklyn <- df_Central_Brooklyn %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Brooklyn <- rename(df_Central_Brooklyn, numRats = df_Central_Brooklyn)
capture_recapture_brooklyn_n2 <- function(year) {
lots_year_1 <- df_Southwest_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southwest_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southwest_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n2)
df_Southwest_Brooklyn <- as.data.frame(df_Southwest_Brooklyn)
df_Southwest_Brooklyn <- df_Southwest_Brooklyn %>%
add_column(Neighborhood = "SOUTHWEST BROOKLYN",
.after = "df_Southwest_Brooklyn")
df_Southwest_Brooklyn <- df_Southwest_Brooklyn %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southwest_Brooklyn <- rename(df_Southwest_Brooklyn, numRats = df_Southwest_Brooklyn)
capture_recapture_brooklyn_n3 <- function(year) {
lots_year_1 <- df_Borough_Park %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Borough_Park %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Borough_Park <- sapply(2011:2021, capture_recapture_brooklyn_n3)
df_Borough_Park <- as.data.frame(df_Borough_Park)
df_Borough_Park <- df_Borough_Park %>%
add_column(Neighborhood = "BOROUGH PARK",
.after = "df_Borough_Park")
df_Borough_Park <- df_Borough_Park %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Borough_Park <- rename(df_Borough_Park, numRats = df_Borough_Park)
capture_recapture_brooklyn_n4 <- function(year) {
lots_year_1 <- df_Canarsie_Flatlands %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Canarsie_Flatlands %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Canarsie_Flatlands <- sapply(2011:2021, capture_recapture_brooklyn_n4)
df_Canarsie_Flatlands <- as.data.frame(df_Canarsie_Flatlands)
df_Canarsie_Flatlands <- df_Canarsie_Flatlands %>%
add_column(Neighborhood = "CANARSIE AND FLATLANDS",
.after = "df_Canarsie_Flatlands")
df_Canarsie_Flatlands <- df_Canarsie_Flatlands %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Canarsie_Flatlands <- rename(df_Canarsie_Flatlands, numRats = df_Canarsie_Flatlands)
capture_recapture_brooklyn_n5 <- function(year) {
lots_year_1 <- df_Southern_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southern_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southern_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n5)
df_Southern_Brooklyn <- as.data.frame(df_Southern_Brooklyn)
df_Southern_Brooklyn <- df_Southern_Brooklyn %>%
add_column(Neighborhood = "SOUTHERN BROOKLYN",
.after = "df_Southern_Brooklyn")
df_Southern_Brooklyn <- df_Southern_Brooklyn %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southern_Brooklyn <- rename(df_Southern_Brooklyn, numRats = df_Southern_Brooklyn)
capture_recapture_brooklyn_n6 <- function(year) {
lots_year_1 <- df_Northwest_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northwest_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northwest_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n6)
df_Northwest_Brooklyn <- as.data.frame(df_Northwest_Brooklyn)
df_Northwest_Brooklyn <- df_Northwest_Brooklyn %>%
add_column(Neighborhood = "NORTHWEST BROOKLYN",
.after = "df_Northwest_Brooklyn")
df_Northwest_Brooklyn <- df_Northwest_Brooklyn %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northwest_Brooklyn <- rename(df_Northwest_Brooklyn, numRats = df_Northwest_Brooklyn)
capture_recapture_brooklyn_n7 <- function(year) {
lots_year_1 <- df_Flatbush %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Flatbush %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Flatbush <- sapply(2011:2021, capture_recapture_brooklyn_n7)
df_Flatbush <- as.data.frame(df_Flatbush)
df_Flatbush <- df_Flatbush %>%
add_column(Neighborhood = "FLATBUSH",
.after = "df_Flatbush")
df_Flatbush <- df_Flatbush %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Flatbush <- rename(df_Flatbush, numRats = df_Flatbush)
capture_recapture_brooklyn_n8 <- function(year) {
lots_year_1 <- df_East_NY_New_Lots %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_East_NY_New_Lots %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_East_NY_New_Lots <- sapply(2011:2021, capture_recapture_brooklyn_n8)
df_East_NY_New_Lots <- as.data.frame(df_East_NY_New_Lots)
df_East_NY_New_Lots <- df_East_NY_New_Lots %>%
add_column(Neighborhood = "EAST NEW YORK AND NEW LOTS",
.after = "df_East_NY_New_Lots")
df_East_NY_New_Lots <- df_East_NY_New_Lots %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_East_NY_New_Lots <- rename(df_East_NY_New_Lots, numRats = df_East_NY_New_Lots)
capture_recapture_brooklyn_n9 <- function(year) {
lots_year_1 <- df_Greenpoint %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Greenpoint %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Greenpoint <- sapply(2011:2021, capture_recapture_brooklyn_n9)
df_Greenpoint <- as.data.frame(df_Greenpoint)
df_Greenpoint <- df_Greenpoint %>%
add_column(Neighborhood = "GREENPOINT",
.after = "df_Greenpoint")
df_Greenpoint <- df_Greenpoint %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Greenpoint <- rename(df_Greenpoint, numRats = df_Greenpoint)
capture_recapture_brooklyn_n10 <- function(year) {
lots_year_1 <- df_Sunset_Park %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Sunset_Park %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Sunset_Park <- sapply(2011:2021, capture_recapture_brooklyn_n10)
df_Sunset_Park <- as.data.frame(df_Sunset_Park)
df_Sunset_Park <- df_Sunset_Park %>%
add_column(Neighborhood = "SUNSET PARK",
.after = "df_Sunset_Park")
df_Sunset_Park <- df_Sunset_Park %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Sunset_Park <- rename(df_Sunset_Park, numRats = df_Sunset_Park)
capture_recapture_brooklyn_n11 <- function(year) {
lots_year_1 <- df_Bushwick_Williamsburg %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Bushwick_Williamsburg %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Bushwick_Williamsburg <- sapply(2011:2021, capture_recapture_brooklyn_n11)
df_Bushwick_Williamsburg <- as.data.frame(df_Bushwick_Williamsburg)
df_Bushwick_Williamsburg <- df_Bushwick_Williamsburg %>%
add_column(Neighborhood = "BUSHWICK AND WILLIAMSBURG",
.after = "df_Bushwick_Williamsburg")
df_Bushwick_Williamsburg <- df_Bushwick_Williamsburg %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Bushwick_Williamsburg <- rename(df_Bushwick_Williamsburg, numRats = df_Bushwick_Williamsburg)
df_Brooklyn_Neighborhood_Rats <- rbind(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
rm(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
graphBrooklynTotal.static <- ggplot(df_Brooklyn_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,250000, by = 25000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphBrooklynTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_manhattan_n1 <- function(year) {
lots_year_1 <- df_Central_Harlem %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Harlem %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Harlem <- sapply(2011:2021, capture_recapture_manhattan_n1)
df_Central_Harlem <- as.data.frame(df_Central_Harlem)
df_Central_Harlem <- df_Central_Harlem %>%
add_column(Neighborhood = "CENTRAL Harlem",
.after = "df_Central_Harlem")
df_Central_Harlem <- df_Central_Harlem %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Harlem <- rename(df_Central_Harlem, numRats = df_Central_Harlem)
capture_recapture_brooklyn_n2 <- function(year) {
lots_year_1 <- df_Southwest_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southwest_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southwest_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n2)
capture_recapture_brooklyn_n1 <- function(year) {
lots_year_1 <- df_Central_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Brooklyn <- sapply(2011:2021, capture_recapture_brooklyn_n1)
install.packages("gganimate")
install.packages("gapminder")
