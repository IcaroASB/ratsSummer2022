df_Sunset_Park <- df_Sunset_Park %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Sunset_Park <- rename(df_Sunset_Park, numRats = df_Sunset_Park)
capture_recapture_brooklyn_n11 <- function(year) {
lots_year_1 <- df_Bushwick_Williamsburg %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Bushwick_Williamsburg %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Bushwick_Williamsburg <- sapply(2011:2021, capture_recapture_brooklyn_n11)
df_Bushwick_Williamsburg <- as.data.frame(df_Bushwick_Williamsburg)
df_Bushwick_Williamsburg <- df_Bushwick_Williamsburg %>%
add_column(Neighborhood = "BUSHWICK AND WILLIAMSBURG",
.after = "df_Bushwick_Williamsburg")
df_Bushwick_Williamsburg <- df_Bushwick_Williamsburg %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Bushwick_Williamsburg <- rename(df_Bushwick_Williamsburg, numRats = df_Bushwick_Williamsburg)
df_Brooklyn_Neighborhood_Rats <- rbind(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
rm(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
graphBrooklynTotal.static <- ggplot(df_Brooklyn_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphBrooklynTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_manhattan_n1 <- function(year) {
lots_year_1 <- df_Central_Harlem %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Harlem %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Harlem <- sapply(2011:2021, capture_recapture_manhattan_n1)
df_Central_Harlem <- as.data.frame(df_Central_Harlem)
df_Central_Harlem <- df_Central_Harlem %>%
add_column(Neighborhood = "CENTRAL HARLEM",
.after = "df_Central_Harlem")
df_Central_Harlem <- df_Central_Harlem %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Harlem <- rename(df_Central_Harlem, numRats = df_Central_Harlem)
capture_recapture_manhattan_n2 <- function(year) {
lots_year_1 <- df_Chelsea_Clinton %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Chelsea_Clinton %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Chelsea_Clinton <- sapply(2011:2021, capture_recapture_manhattan_n2)
df_Chelsea_Clinton <- as.data.frame(df_Chelsea_Clinton)
df_Chelsea_Clinton <- df_Chelsea_Clinton %>%
add_column(Neighborhood = "CHELSEA AND CLINTON",
.after = "df_Chelsea_Clinton")
df_Chelsea_Clinton <- df_Chelsea_Clinton %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Chelsea_Clinton <- rename(df_Chelsea_Clinton, numRats = df_Chelsea_Clinton)
capture_recapture_manhattan_n3 <- function(year) {
lots_year_1 <- df_East_Harlem %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_East_Harlem %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_East_Harlem <- sapply(2011:2021, capture_recapture_manhattan_n3)
df_East_Harlem <- as.data.frame(df_East_Harlem)
df_East_Harlem <- df_East_Harlem %>%
add_column(Neighborhood = "EAST HARLEM",
.after = "df_East_Harlem")
df_East_Harlem <- df_East_Harlem %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_East_Harlem <- rename(df_East_Harlem, numRats = df_East_Harlem)
capture_recapture_manhattan_n4 <- function(year) {
lots_year_1 <- df_Gramercy_Park_Murray_Hill %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Gramercy_Park_Murray_Hill %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Gramercy_Park_Murray_Hill <- sapply(2011:2021, capture_recapture_manhattan_n4)
df_Gramercy_Park_Murray_Hill <- as.data.frame(df_Gramercy_Park_Murray_Hill)
df_Gramercy_Park_Murray_Hill <- df_Gramercy_Park_Murray_Hill %>%
add_column(Neighborhood = "GRAMERCY PARK AND MURRAY HILL",
.after = "df_Gramercy_Park_Murray_Hill")
df_Gramercy_Park_Murray_Hill <- df_Gramercy_Park_Murray_Hill %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Gramercy_Park_Murray_Hill <- rename(df_Gramercy_Park_Murray_Hill, numRats = df_Gramercy_Park_Murray_Hill)
capture_recapture_manhattan_n5 <- function(year) {
lots_year_1 <- df_Greenwich_Village_SoHo %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Greenwich_Village_SoHo %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Greenwich_Village_SoHo <- sapply(2011:2021, capture_recapture_manhattan_n5)
df_Greenwich_Village_SoHo <- as.data.frame(df_Greenwich_Village_SoHo)
df_Greenwich_Village_SoHo <- df_Greenwich_Village_SoHo %>%
add_column(Neighborhood = "GREENWICH VILLAGE AND SOHO",
.after = "df_Greenwich_Village_SoHo")
df_Greenwich_Village_SoHo <- df_Greenwich_Village_SoHo %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Greenwich_Village_SoHo <- rename(df_Greenwich_Village_SoHo, numRats = df_Greenwich_Village_SoHo)
capture_recapture_manhattan_n6 <- function(year) {
lots_year_1 <- df_Lower_Manhattan %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Lower_Manhattan %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Lower_Manhattan <- sapply(2011:2021, capture_recapture_manhattan_n6)
df_Lower_Manhattan <- as.data.frame(df_Lower_Manhattan)
df_Lower_Manhattan <- df_Lower_Manhattan %>%
add_column(Neighborhood = "LOWER MANHATTAN",
.after = "df_Lower_Manhattan")
df_Lower_Manhattan <- df_Lower_Manhattan %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Lower_Manhattan <- rename(df_Lower_Manhattan, numRats = df_Lower_Manhattan)
capture_recapture_manhattan_n7 <- function(year) {
lots_year_1 <- df_Lower_East %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Lower_East %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Lower_East <- sapply(2011:2021, capture_recapture_manhattan_n7)
df_Lower_East <- as.data.frame(df_Lower_East)
df_Lower_East <- df_Lower_East %>%
add_column(Neighborhood = "LOWER EAST SIDE",
.after = "df_Lower_East")
df_Lower_East <- df_Lower_East %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Lower_East <- rename(df_Lower_East, numRats = df_Lower_East)
capture_recapture_manhattan_n8 <- function(year) {
lots_year_1 <- df_Upper_East %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Upper_East %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Upper_East <- sapply(2011:2021, capture_recapture_manhattan_n8)
df_Upper_East <- as.data.frame(df_Upper_East)
df_Upper_East <- df_Upper_East %>%
add_column(Neighborhood = "UPPER EAST SIDE",
.after = "df_Upper_East")
df_Upper_East <- df_Upper_East %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Upper_East <- rename(df_Upper_East, numRats = df_Upper_East)
capture_recapture_manhattan_n9 <- function(year) {
lots_year_1 <- df_Upper_West %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Upper_West %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Upper_West <- sapply(2011:2021, capture_recapture_manhattan_n9)
df_Upper_West <- as.data.frame(df_Upper_West)
df_Upper_West <- df_Upper_West %>%
add_column(Neighborhood = "UPPER WEST SIDE",
.after = "df_Upper_West")
df_Upper_West <- df_Upper_West %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Upper_West <- rename(df_Upper_West, numRats = df_Upper_West)
capture_recapture_manhattan_n10 <- function(year) {
lots_year_1 <- df_Inwood_Washington_Heights %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Inwood_Washington_Heights %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Inwood_Washington_Heights <- sapply(2011:2021, capture_recapture_manhattan_n10)
df_Inwood_Washington_Heights <- as.data.frame(df_Inwood_Washington_Heights)
df_Inwood_Washington_Heights <- df_Inwood_Washington_Heights %>%
add_column(Neighborhood = "INWOOD AND WASHINGTON HEIGHTS",
.after = "df_Inwood_Washington_Heights")
df_Inwood_Washington_Heights <- df_Inwood_Washington_Heights %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Inwood_Washington_Heights <- rename(df_Inwood_Washington_Heights, numRats = df_Inwood_Washington_Heights)
df_Manhattan_Neighborhood_Rats <- rbind(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East, df_Upper_West, df_Inwood_Washington_Heights)
rm(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East, df_Upper_West, df_Inwood_Washington_Heights)
graphManhattanTotal.static <- ggplot(df_Manhattan_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphManhattanTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_queens_n1 <- function(year) {
lots_year_1 <- df_Northeast_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northeast_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northeast_Queens <- sapply(2011:2021, capture_recapture_queens_n1)
df_Northeast_Queens <- as.data.frame(df_Northeast_Queens)
df_Northeast_Queens <- df_Northeast_Queens %>%
add_column(Neighborhood = "NORTHEAST QUEENS",
.after = "df_Northeast_Queens")
df_Northeast_Queens <- df_Northeast_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northeast_Queens <- rename(df_Northeast_Queens, numRats = df_Northeast_Queens)
capture_recapture_queens_n2 <- function(year) {
lots_year_1 <- df_North_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_North_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_North_Queens <- sapply(2011:2021, capture_recapture_queens_n2)
df_North_Queens <- as.data.frame(df_North_Queens)
df_North_Queens <- df_North_Queens %>%
add_column(Neighborhood = "NORTH QUEENS",
.after = "df_North_Queens")
df_North_Queens <- df_North_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_North_Queens <- rename(df_North_Queens, numRats = df_North_Queens)
capture_recapture_queens_n3 <- function(year) {
lots_year_1 <- df_Central_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Queens <- sapply(2011:2021, capture_recapture_queens_n3)
df_Central_Queens <- as.data.frame(df_Central_Queens)
df_Central_Queens <- df_Central_Queens %>%
add_column(Neighborhood = "CENTRAL QUEENS",
.after = "df_Central_Queens")
df_Central_Queens <- df_Central_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Queens <- rename(df_Central_Queens, numRats = df_Central_Queens)
capture_recapture_queens_n4 <- function(year) {
lots_year_1 <- df_Jamaica %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Jamaica %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Jamaica <- sapply(2011:2021, capture_recapture_queens_n4)
df_Jamaica <- as.data.frame(df_Jamaica)
df_Jamaica <- df_Jamaica %>%
add_column(Neighborhood = "JAMAICA",
.after = "df_Jamaica")
df_Jamaica <- df_Jamaica %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Jamaica <- rename(df_Jamaica, numRats = df_Jamaica)
capture_recapture_queens_n5 <- function(year) {
lots_year_1 <- df_Northwest_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northwest_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northwest_Queens <- sapply(2011:2021, capture_recapture_queens_n5)
df_Northwest_Queens <- as.data.frame(df_Northwest_Queens)
df_Northwest_Queens <- df_Northwest_Queens %>%
add_column(Neighborhood = "NORTHWEST QUEENS",
.after = "df_Northwest_Queens")
df_Northwest_Queens <- df_Northwest_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northwest_Queens <- rename(df_Northwest_Queens, numRats = df_Northwest_Queens)
capture_recapture_queens_n6 <- function(year) {
lots_year_1 <- df_West_Central_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_West_Central_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_West_Central_Queens <- sapply(2011:2021, capture_recapture_queens_n6)
df_West_Central_Queens <- as.data.frame(df_West_Central_Queens)
df_West_Central_Queens <- df_West_Central_Queens %>%
add_column(Neighborhood = "WEST CENTRAL QUEENS",
.after = "df_West_Central_Queens")
df_West_Central_Queens <- df_West_Central_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_West_Central_Queens <- rename(df_West_Central_Queens, numRats = df_West_Central_Queens)
capture_recapture_queens_n7 <- function(year) {
lots_year_1 <- df_Rockaways %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Rockaways %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Rockaways <- sapply(2011:2021, capture_recapture_queens_n7)
df_Rockaways <- as.data.frame(df_Rockaways)
df_Rockaways <- df_Rockaways %>%
add_column(Neighborhood = "ROCKAWAYS",
.after = "df_Rockaways")
df_Rockaways <- df_Rockaways %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Rockaways <- rename(df_Rockaways, numRats = df_Rockaways)
capture_recapture_queens_n8 <- function(year) {
lots_year_1 <- df_Southeast_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southeast_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southeast_Queens <- sapply(2011:2021, capture_recapture_queens_n8)
df_Southeast_Queens <- as.data.frame(df_Southeast_Queens)
df_Southeast_Queens <- df_Southeast_Queens %>%
add_column(Neighborhood = "SOUTHEAST QUEENS",
.after = "df_Southeast_Queens")
df_Southeast_Queens <- df_Southeast_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southeast_Queens <- rename(df_Southeast_Queens, numRats = df_Southeast_Queens)
capture_recapture_queens_n9 <- function(year) {
lots_year_1 <- df_Southwest_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southwest_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southwest_Queens <- sapply(2011:2021, capture_recapture_queens_n9)
df_Southwest_Queens <- as.data.frame(df_Southwest_Queens)
df_Southwest_Queens <- df_Southwest_Queens %>%
add_column(Neighborhood = "SOUTHWEST QUEENS",
.after = "df_Southwest_Queens")
df_Southwest_Queens <- df_Southwest_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southwest_Queens <- rename(df_Southwest_Queens, numRats = df_Southwest_Queens)
capture_recapture_queens_n10 <- function(year) {
lots_year_1 <- df_West_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_West_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_West_Queens <- sapply(2011:2021, capture_recapture_queens_n10)
df_West_Queens <- as.data.frame(df_West_Queens)
df_West_Queens <- df_West_Queens %>%
add_column(Neighborhood = "WEST QUEENS",
.after = "df_West_Queens")
df_West_Queens <- df_West_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_West_Queens <- rename(df_West_Queens, numRats = df_West_Queens)
df_Queens_Neighborhood_Rats <- rbind(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
rm(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
graphQueensTotal.static <- ggplot(df_Queens_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphQueensTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_staten_island_n1 <- function(year) {
lots_year_1 <- df_Port_Richmond %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Port_Richmond %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Port_Richmond <- sapply(2011:2021, capture_recapture_staten_island_n1)
df_Port_Richmond <- as.data.frame(df_Port_Richmond)
df_Port_Richmond <- df_Port_Richmond %>%
add_column(Neighborhood = "PORT RICHMOND",
.after = "df_Port_Richmond")
df_Port_Richmond <- df_Port_Richmond %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Port_Richmond <- rename(df_Port_Richmond, numRats = df_Port_Richmond)
capture_recapture_staten_island_n2 <- function(year) {
lots_year_1 <- df_South_Shore %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_South_Shore %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_South_Shore <- sapply(2011:2021, capture_recapture_staten_island_n2)
df_South_Shore <- as.data.frame(df_South_Shore)
df_South_Shore <- df_South_Shore %>%
add_column(Neighborhood = "SOUTH SHORE",
.after = "df_South_Shore")
df_South_Shore <- df_South_Shore %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_South_Shore <- rename(df_South_Shore, numRats = df_South_Shore)
capture_recapture_staten_island_n3 <- function(year) {
lots_year_1 <- df_Stapleton_StGeorge %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Stapleton_StGeorge %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Stapleton_StGeorge <- sapply(2011:2021, capture_recapture_staten_island_n3)
df_Stapleton_StGeorge <- as.data.frame(df_Stapleton_StGeorge)
df_Stapleton_StGeorge <- df_Stapleton_StGeorge %>%
add_column(Neighborhood = "STAPLETON AND ST. GEORGE",
.after = "df_Stapleton_StGeorge")
df_Stapleton_StGeorge <- df_Stapleton_StGeorge %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Stapleton_StGeorge <- rename(df_Stapleton_StGeorge, numRats = df_Stapleton_StGeorge)
capture_recapture_staten_island_n4 <- function(year) {
lots_year_1 <- df_MidIsland %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_MidIsland %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_MidIsland <- sapply(2011:2021, capture_recapture_staten_island_n4)
df_MidIsland <- as.data.frame(df_MidIsland)
df_MidIsland <- df_MidIsland %>%
add_column(Neighborhood = "MID ISLAND",
.after = "df_MidIsland")
df_MidIsland <- df_MidIsland %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_MidIsland <- rename(df_MidIsland, numRats = df_MidIsland)
df_Staten_Island_Neighborhood_Rats <- rbind(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
rm(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
graphStatenTotal.static <- ggplot(df_Staten_Island_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphStatenTotalN.png", height = 2400, width = 3840, units = "px")
options(scipen = 999)
df_NYC_Num_Rats <- list( df_Brooklyn_Num_Rats, df_Queens_Num_Rats,  df_Manhattan_Num_Rats, df_The_Bronx_Num_Rats, df_Staten_Island_Num_Rats)
df_NYC_Num_Rats <- Reduce(function(x,y) merge(x,y, all = TRUE), df_NYC_Num_Rats)
df_NYC_Num_Rats <- df_NYC_Num_Rats[order(df_NYC_Num_Rats$numRats),]
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1.png", height = 1600, width = 2560, units = "px")
graph2.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text())
ggsave("graph2.png", height = 1600, width = 2560, units = "px")
graph1.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Do Rats Proliferate Faster in Certain Boroughs?", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph1.anim, height = 1000, width = 1600, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph1anim.gif")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph2.anim, height = 1000, width = 1600, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph2anim.gif")
