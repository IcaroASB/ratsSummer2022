add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Harlem <- rename(df_Central_Harlem, numRats = df_Central_Harlem)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Chelsea_Clinton %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Chelsea_Clinton %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Chelsea_Clinton <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Chelsea_Clinton <- as.data.frame(df_Chelsea_Clinton)
df_Chelsea_Clinton <- df_Chelsea_Clinton %>%
add_column(Neighborhood = "CHELSEA AND CLINTON",
.after = "df_Chelsea_Clinton")
df_Chelsea_Clinton <- df_Chelsea_Clinton %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Chelsea_Clinton <- rename(df_Chelsea_Clinton, numRats = df_Chelsea_Clinton)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_East_Harlem %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_East_Harlem %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_East_Harlem <- sapply(2011:2021, capture_recapture_manhattan_n)
df_East_Harlem <- as.data.frame(df_East_Harlem)
df_East_Harlem <- df_East_Harlem %>%
add_column(Neighborhood = "EAST HARLEM",
.after = "df_East_Harlem")
df_East_Harlem <- df_East_Harlem %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_East_Harlem <- rename(df_East_Harlem, numRats = df_East_Harlem)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Gramercy_Park_Murray_Hill %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Gramercy_Park_Murray_Hill %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Gramercy_Park_Murray_Hill <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Gramercy_Park_Murray_Hill <- as.data.frame(df_Gramercy_Park_Murray_Hill)
df_Gramercy_Park_Murray_Hill <- df_Gramercy_Park_Murray_Hill %>%
add_column(Neighborhood = "GRAMERCY PARK AND MURRAY HILL",
.after = "df_Gramercy_Park_Murray_Hill")
df_Gramercy_Park_Murray_Hill <- df_Gramercy_Park_Murray_Hill %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Gramercy_Park_Murray_Hill <- rename(df_Gramercy_Park_Murray_Hill, numRats = df_Gramercy_Park_Murray_Hill)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Greenwich_Village_SoHo %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Greenwich_Village_SoHo %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Greenwich_Village_SoHo <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Greenwich_Village_SoHo <- as.data.frame(df_Greenwich_Village_SoHo)
df_Greenwich_Village_SoHo <- df_Greenwich_Village_SoHo %>%
add_column(Neighborhood = "GREENWICH VILLAGE AND SOHO",
.after = "df_Greenwich_Village_SoHo")
df_Greenwich_Village_SoHo <- df_Greenwich_Village_SoHo %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Greenwich_Village_SoHo <- rename(df_Greenwich_Village_SoHo, numRats = df_Greenwich_Village_SoHo)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Lower_Manhattan %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Lower_Manhattan %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Lower_Manhattan <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Lower_Manhattan <- as.data.frame(df_Lower_Manhattan)
df_Lower_Manhattan <- df_Lower_Manhattan %>%
add_column(Neighborhood = "LOWER MANHATTAN",
.after = "df_Lower_Manhattan")
df_Lower_Manhattan <- df_Lower_Manhattan %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Lower_Manhattan <- rename(df_Lower_Manhattan, numRats = df_Lower_Manhattan)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Lower_East %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Lower_East %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Lower_East <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Lower_East <- as.data.frame(df_Lower_East)
df_Lower_East <- df_Lower_East %>%
add_column(Neighborhood = "LOWER EAST SIDE",
.after = "df_Lower_East")
df_Lower_East <- df_Lower_East %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Lower_East <- rename(df_Lower_East, numRats = df_Lower_East)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Upper_East %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Upper_East %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Upper_East <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Upper_East <- as.data.frame(df_Upper_East)
df_Upper_East <- df_Upper_East %>%
add_column(Neighborhood = "UPPER EAST SIDE",
.after = "df_Upper_East")
df_Upper_East <- df_Upper_East %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Upper_East <- rename(df_Upper_East, numRats = df_Upper_East)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Upper_West %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Upper_West %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Upper_West <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Upper_West <- as.data.frame(df_Upper_West)
df_Upper_West <- df_Upper_West %>%
add_column(Neighborhood = "UPPER WEST SIDE",
.after = "df_Upper_West")
df_Upper_West <- df_Upper_West %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Upper_West <- rename(df_Upper_West, numRats = df_Upper_West)
capture_recapture_manhattan_n <- function(year) {
lots_year_1 <- df_Inwood_Washington_Heights %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Inwood_Washington_Heights %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Inwood_Washington_Heights <- sapply(2011:2021, capture_recapture_manhattan_n)
df_Inwood_Washington_Heights <- as.data.frame(df_Inwood_Washington_Heights)
df_Inwood_Washington_Heights <- df_Inwood_Washington_Heights %>%
add_column(Neighborhood = "INWOOD AND WASHINGTON HEIGHTS",
.after = "df_Inwood_Washington_Heights")
df_Inwood_Washington_Heights <- df_Inwood_Washington_Heights %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Inwood_Washington_Heights <- rename(df_Inwood_Washington_Heights, numRats = df_Inwood_Washington_Heights)
df_Manhattan_Neighborhood_Rats <- rbind(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East, df_Upper_West, df_Inwood_Washington_Heights)
rm(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East, df_Upper_West, df_Inwood_Washington_Heights)
graphManhattanTotal.static <- ggplot(df_Manhattan_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5, aes(alpha = Neighborhood)) +
scale_alpha_manual(values=c(0.3,1,0.3,0.3,1,0.3,0.3,0.3,0.3,0.3)) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphManhattanTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Northeast_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northeast_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northeast_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_Northeast_Queens <- as.data.frame(df_Northeast_Queens)
df_Northeast_Queens <- df_Northeast_Queens %>%
add_column(Neighborhood = "NORTHEAST QUEENS",
.after = "df_Northeast_Queens")
df_Northeast_Queens <- df_Northeast_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northeast_Queens <- rename(df_Northeast_Queens, numRats = df_Northeast_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_North_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_North_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_North_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_North_Queens <- as.data.frame(df_North_Queens)
df_North_Queens <- df_North_Queens %>%
add_column(Neighborhood = "NORTH QUEENS",
.after = "df_North_Queens")
df_North_Queens <- df_North_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_North_Queens <- rename(df_North_Queens, numRats = df_North_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Central_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Central_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Central_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_Central_Queens <- as.data.frame(df_Central_Queens)
df_Central_Queens <- df_Central_Queens %>%
add_column(Neighborhood = "CENTRAL QUEENS",
.after = "df_Central_Queens")
df_Central_Queens <- df_Central_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Central_Queens <- rename(df_Central_Queens, numRats = df_Central_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Jamaica %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Jamaica %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Jamaica <- sapply(2011:2021, capture_recapture_queens_n)
df_Jamaica <- as.data.frame(df_Jamaica)
df_Jamaica <- df_Jamaica %>%
add_column(Neighborhood = "JAMAICA",
.after = "df_Jamaica")
df_Jamaica <- df_Jamaica %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Jamaica <- rename(df_Jamaica, numRats = df_Jamaica)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Northwest_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Northwest_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Northwest_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_Northwest_Queens <- as.data.frame(df_Northwest_Queens)
df_Northwest_Queens <- df_Northwest_Queens %>%
add_column(Neighborhood = "NORTHWEST QUEENS",
.after = "df_Northwest_Queens")
df_Northwest_Queens <- df_Northwest_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Northwest_Queens <- rename(df_Northwest_Queens, numRats = df_Northwest_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_West_Central_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_West_Central_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_West_Central_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_West_Central_Queens <- as.data.frame(df_West_Central_Queens)
df_West_Central_Queens <- df_West_Central_Queens %>%
add_column(Neighborhood = "WEST CENTRAL QUEENS",
.after = "df_West_Central_Queens")
df_West_Central_Queens <- df_West_Central_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_West_Central_Queens <- rename(df_West_Central_Queens, numRats = df_West_Central_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Rockaways %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Rockaways %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Rockaways <- sapply(2011:2021, capture_recapture_queens_n)
df_Rockaways <- as.data.frame(df_Rockaways)
df_Rockaways <- df_Rockaways %>%
add_column(Neighborhood = "ROCKAWAYS",
.after = "df_Rockaways")
df_Rockaways <- df_Rockaways %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Rockaways <- rename(df_Rockaways, numRats = df_Rockaways)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Southeast_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southeast_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southeast_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_Southeast_Queens <- as.data.frame(df_Southeast_Queens)
df_Southeast_Queens <- df_Southeast_Queens %>%
add_column(Neighborhood = "SOUTHEAST QUEENS",
.after = "df_Southeast_Queens")
df_Southeast_Queens <- df_Southeast_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southeast_Queens <- rename(df_Southeast_Queens, numRats = df_Southeast_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_Southwest_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Southwest_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Southwest_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_Southwest_Queens <- as.data.frame(df_Southwest_Queens)
df_Southwest_Queens <- df_Southwest_Queens %>%
add_column(Neighborhood = "SOUTHWEST QUEENS",
.after = "df_Southwest_Queens")
df_Southwest_Queens <- df_Southwest_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Southwest_Queens <- rename(df_Southwest_Queens, numRats = df_Southwest_Queens)
capture_recapture_queens_n <- function(year) {
lots_year_1 <- df_West_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_West_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_West_Queens <- sapply(2011:2021, capture_recapture_queens_n)
df_West_Queens <- as.data.frame(df_West_Queens)
df_West_Queens <- df_West_Queens %>%
add_column(Neighborhood = "WEST QUEENS",
.after = "df_West_Queens")
df_West_Queens <- df_West_Queens %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_West_Queens <- rename(df_West_Queens, numRats = df_West_Queens)
df_Queens_Neighborhood_Rats <- rbind(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
rm(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
graphQueensTotal.static <- ggplot(df_Queens_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5, aes(alpha = Neighborhood)) +
scale_alpha_manual(values=c(1,0.3,0.3,1,0.3,1,1,0.3,0.3,0.3)) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,400000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphQueensTotalN.png", height = 2400, width = 3840, units = "px")
capture_recapture_staten_island_n <- function(year) {
lots_year_1 <- df_Port_Richmond %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Port_Richmond %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Port_Richmond <- sapply(2011:2021, capture_recapture_staten_island_n)
df_Port_Richmond <- as.data.frame(df_Port_Richmond)
df_Port_Richmond <- df_Port_Richmond %>%
add_column(Neighborhood = "PORT RICHMOND",
.after = "df_Port_Richmond")
df_Port_Richmond <- df_Port_Richmond %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Port_Richmond <- rename(df_Port_Richmond, numRats = df_Port_Richmond)
capture_recapture_staten_island_n <- function(year) {
lots_year_1 <- df_South_Shore %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_South_Shore %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_South_Shore <- sapply(2011:2021, capture_recapture_staten_island_n)
df_South_Shore <- as.data.frame(df_South_Shore)
df_South_Shore <- df_South_Shore %>%
add_column(Neighborhood = "SOUTH SHORE",
.after = "df_South_Shore")
df_South_Shore <- df_South_Shore %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_South_Shore <- rename(df_South_Shore, numRats = df_South_Shore)
capture_recapture_staten_island_n <- function(year) {
lots_year_1 <- df_Stapleton_StGeorge %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Stapleton_StGeorge %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Stapleton_StGeorge <- sapply(2011:2021, capture_recapture_staten_island_n)
df_Stapleton_StGeorge <- as.data.frame(df_Stapleton_StGeorge)
df_Stapleton_StGeorge <- df_Stapleton_StGeorge %>%
add_column(Neighborhood = "STAPLETON AND ST. GEORGE",
.after = "df_Stapleton_StGeorge")
df_Stapleton_StGeorge <- df_Stapleton_StGeorge %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_Stapleton_StGeorge <- rename(df_Stapleton_StGeorge, numRats = df_Stapleton_StGeorge)
capture_recapture_staten_island_n <- function(year) {
lots_year_1 <- df_MidIsland %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_MidIsland %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_MidIsland <- sapply(2011:2021, capture_recapture_staten_island_n)
df_MidIsland <- as.data.frame(df_MidIsland)
df_MidIsland <- df_MidIsland %>%
add_column(Neighborhood = "MID ISLAND",
.after = "df_MidIsland")
df_MidIsland <- df_MidIsland %>%
add_column(Year = 2011:2021,
.after = "Neighborhood")
df_MidIsland <- rename(df_MidIsland, numRats = df_MidIsland)
df_Staten_Island_Neighborhood_Rats <- rbind(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
rm(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
graphStatenTotal.static <- ggplot(df_Staten_Island_Neighborhood_Rats, aes(x = Year, y = numRats, color = Neighborhood)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,350000, by = 50000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graphStatenTotalN.png", height = 2400, width = 3840, units = "px")
write.csv(df_The_Bronx_Neighborhood_Rats, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_The_Bronx_Neighborhoods.csv", row.names=FALSE)
write.csv(df_Brooklyn_Neighborhood_Rats, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_Brooklyn_Neighborhoods.csv", row.names=FALSE)
write.csv(df_Manhattan_Neighborhood_Rats, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_Manhattan_Neighborhoods.csv", row.names=FALSE)
write.csv(df_Queens_Neighborhood_Rats, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_Queens_Neighborhoods.csv", row.names=FALSE)
write.csv(df_Staten_Island_Neighborhood_Rats, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_Staten_Island_Neighborhoods.csv", row.names=FALSE)
nyc_capita_area <- read_csv("nyc_pop_zip_area_2020_by_neigborhood.csv")
nyc_neighborhoods_2020 <- rbind(df_The_Bronx_Neighborhood_Rats, df_Brooklyn_Neighborhood_Rats, df_Manhattan_Neighborhood_Rats, df_Queens_Neighborhood_Rats, df_Staten_Island_Neighborhood_Rats)
nyc_neighborhoods_2020 <- nyc_neighborhoods_2020 %>% filter(Year == 2020)
df_nyc_ratio_and_density <- merge(nyc_capita_area,nyc_neighborhoods_2020)
df_nyc_ratio_and_density <- df_nyc_ratio_and_density %>% mutate(human_rat_ratio = numRats/human_population)
df_nyc_ratio_and_density <- df_nyc_ratio_and_density %>% mutate(rats_per_sqm = numRats/square_meter)
write.csv(df_nyc_ratio_and_density, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\df_nyc_ratio_and_density.csv", row.names=FALSE)
mean(df_nyc_ratio_and_density$human_rat_ratio)
median(df_nyc_ratio_and_density$human_rat_ratio)
mean(df_nyc_ratio_and_density$rats_per_sqm)
median(df_nyc_ratio_and_density$rats_per_sqm)
ggplot(df_nyc_ratio_and_density,aes(x = rats_per_sqm, y = human_rat_ratio, color = Neighborhood)) +
geom_point() +
geom_label_repel(aes(label = Neighborhood),
box.padding   = 0.35,
point.padding = 0.5,
segment.color = 'grey50') +
labs (title = "Rats Ratio 2020", subtitle = "How many Rats are there per person? How many Rats per square meter?", x = "Rat / Square Meter", y = "Rat-Human Ratio" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
theme(legend.position="none")
ggsave("graphNYCRatio.png", height = 3840, width = 3840, units = "px")
open_parking_violations <- read_csv("july_11_hydrant_violations.csv")
observed_violations <- read_csv("july_11_observations.csv")
result <- merge(open_parking_violations, observed_violations, by = "Plate")
write.csv(result, "C:\\Users\\Admin\\Desktop\\RatsData\\DataSets\\result.csv", row.names=FALSE)
install.packages("ggmap")
library("ggmap")
register_google("AIzaSyBw3UEAd20Hs6sAbqqfkSsEFoJXVfPn04U")
Manhattan_observed.map <- get_map(location= 'Manhattan, New York',
maptype='roadmap', color='bw',source='google',zoom=12)
ggmap(Manhattan_observed.map) +
geom_point(observed_violations, color='red', size=2, mapping = aes(x=longdd, y=latdd)) +
theme(axis.ticks = element_blank(), axis.text = element_blank()) +
xlab('') + ylab('')
ggsave("observed_manhattan.png", height = 1920, width = 1920, units = "px")
Manhattan_ticketed.map <- get_map(location= 'Manhattan, New York',
maptype='roadmap', color='bw',source='google',zoom=12)
ggmap(Manhattan_ticketed.map) +
geom_point(result, color='red', size=2, mapping = aes(x=longdd, y=latdd)) +
theme(axis.ticks = element_blank(), axis.text = element_blank()) +
xlab('') + ylab('')
ggsave("ticketed_manhattan.png", height = 1920, width = 1920, units = "px")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC (Capture-Recapture by Borough)", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph2.anim, height = 1000, width = 1600, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph2animv2.gif")
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Capture-Recapture by Borough", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1v2.png", height = 1600, width = 2560, units = "px")
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "(Capture-Recapture by Borough)", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1v2.png", height = 1600, width = 2560, units = "px")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", subtitle = "(Capture-Recapture by Borough)", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph2.anim, height = 1000, width = 1600, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph2animv2.gif")
