#   add_column(Group = "NYC",
#              .after = "df_NYC_Num_Rats")
#
# df_NYC_Num_Rats <- df_NYC_Num_Rats %>%
#   add_column(Year = 11:21,
#              .after = "Group")
#
# df_NYC_Num_Rats <- rename(df_NYC_Num_Rats, numRats = df_NYC_Num_Rats)
options(scipen = 999)
df_NYC_Num_Rats <- list( df_Brooklyn_Num_Rats, df_Queens_Num_Rats,  df_Manhattan_Num_Rats, df_The_Bronx_Num_Rats, df_Staten_Island_Num_Rats)
df_NYC_Num_Rats <- Reduce(function(x,y) merge(x,y, all = TRUE), df_NYC_Num_Rats)
df_NYC_Num_Rats <- df_NYC_Num_Rats[order(df_NYC_Num_Rats$numRats),]
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1.png", height = 1440, width = 2560, units = "px")
graph2.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text())
ggsave("graph2.png", height = 1440, width = 2560, units = "px")
graph1.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Do Rats Proliferate Faster in Certain Boroughs?", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph1.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph1anim.gif")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph2.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph2anim.gif")
install.packages("gganimate")
install.packages("gapminder")
install.packages("ggthemes")
library("tidyverse")
library("ggplot2")
library("gganimate")
library("dplyr")
library("gapminder")
library("ggthemes")
calls <- read_csv("nyc_rodent_compliants.csv")
df_NYC <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%Y")) %>%
filter(Descriptor == "Rat Sighting") %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
df_NYC <- rename(df_NYC, Zip  = `Incident Zip` )
df_NYC <- df_NYC %>% filter(Zip %in% (10001:11697))
df_NYC <- separate(df_NYC, "Month_Year", c("Month","Year"), sep = "/")
df_NYC <- df_NYC[order(df_NYC$Year),]
write.csv(df_NYC, "C:\\Users\\Admin\\Desktop\\df_NYC.csv", row.names=FALSE)
# lots_year_1 <- df_NYC %>% filter(Year == "2020") %>% pull(BBL)
# lots_year_2 <- df_NYC %>% filter(Year == "2021") %>% pull(BBL)
# number_in_year_1 <- length(lots_year_1)
# number_in_year_2 <- length(lots_year_2)
# number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#
# number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# 50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# capture_recapture <- function(year) {
#   lots_year_1 <- df_NYC %>% filter(Year == year - 1) %>% pull(BBL)
#   lots_year_2 <- df_NYC %>% filter(Year == year) %>% pull(BBL)
#   number_in_year_1 <- length(lots_year_1)
#   number_in_year_2 <- length(lots_year_2)
#   number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#   50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# }
# qplot(x = factor(2011:2021),
#       weight = sapply(2011:2021, capture_recapture),
#       geom = "bar")  +
#   labs(x = "year",
#        y = "estimated rat population") +
#   theme_bw()
# library(ggplot2)
# ggplot(df_NYC, aes(fill= Borough, y = count , x = Year)) +
#   geom_bar(position = "stack", stat = "identity")
# lots_year_18 <- df_NYC %>% filter(Year == "18") %>% select(BBL, Borough, Zip)
# lots_year_19 <- df_NYC %>% filter(Year == "19") %>% select(BBL, Borough, Zip)
#
# common_lots_18_19 <- inner_join(lots_year_18, lots_year_19)
df_Central_Bronx <- df_NYC %>% filter(Zip%in% c(10453, 10457, 10460))
df_Central_Bronx$Neighborhood <- "CENTRAL BRONX"
df_Bronx_Park_Fordham <- df_NYC %>% filter(Zip%in% c(10458, 10467, 10468))
df_Bronx_Park_Fordham$Neighborhood <- "BRONX PARK AND FORDHAM"
df_High_Bridge_Morrisania <- df_NYC %>% filter(Zip%in% c(10451, 10452, 10456))
df_High_Bridge_Morrisania$Neighborhood <- "HIGH BRIDGE AND MORRISANIA"
df_Hunts_Point_Mott_Haven <- df_NYC %>% filter(Zip%in% c(10454, 10455, 10459, 10474))
df_Hunts_Point_Mott_Haven$Neighborhood <- "HUNTS POINT AND MOTT HAVEN"
df_Kingsbridge_Riverdale <- df_NYC %>% filter(Zip%in% c(10463, 10471))
df_Kingsbridge_Riverdale$Neighborhood <- "KINGSBRIDGE AND RIVERDALE"
df_Northeast_Bronx <- df_NYC %>% filter(Zip%in% c(10466, 10469, 10470, 10475))
df_Northeast_Bronx$Neighborhood <- "NORTHEAST BRONX"
df_Southeast_Bronx <- df_NYC %>% filter(Zip%in% c(10461, 10462, 10464, 10465, 10472, 10473))
df_Southeast_Bronx$Neighborhood <- "SOUTHEAST BRONX"
df_The_Bronx <- rbind(df_Central_Bronx, df_Bronx_Park_Fordham, df_High_Bridge_Morrisania, df_Hunts_Point_Mott_Haven, df_Kingsbridge_Riverdale, df_Northeast_Bronx, df_Southeast_Bronx)
df_Central_Brooklyn <- df_NYC %>% filter(Zip%in% c(11212, 11213, 11216, 11233, 11238))
df_Central_Brooklyn$Neighborhood <- "CENTRAL BROOKLYN"
df_Southwest_Brooklyn <- df_NYC %>% filter(Zip%in% c(11209, 11214, 11228))
df_Southwest_Brooklyn$Neighborhood <- "SOUTHWEST BROOKLYN"
df_Borough_Park <- df_NYC %>% filter(Zip%in% c(11204, 11218, 11219, 11230))
df_Borough_Park$Neighborhood <- "BOROUGH PARK"
df_Canarsie_Flatlands <- df_NYC %>% filter(Zip%in% c(11234, 11236, 11239))
df_Canarsie_Flatlands$Neighborhood <- "CANARSIE AND FLATLANDS"
df_Southern_Brooklyn <- df_NYC %>% filter(Zip%in% c(11223, 11224, 11229, 11235))
df_Southern_Brooklyn$Neighborhood <- "SOUTHERN BROOKLYN"
df_Northwest_Brooklyn <- df_NYC %>% filter(Zip%in% c(11201, 11205, 11215, 11217, 11231))
df_Northwest_Brooklyn$Neighborhood <- "NORTHWEST BROOKLYN"
df_Flatbush <- df_NYC %>% filter(Zip%in% c(11203, 11210, 11225, 11226))
df_Flatbush$Neighborhood <- "FLATBUSH"
df_East_NY_New_Lots <- df_NYC %>% filter(Zip%in% c(11207, 11208))
df_East_NY_New_Lots$Neighborhood <- "EAST NEW YORK AND NEW LOTS"
df_Greenpoint <- df_NYC %>% filter(Zip%in% c(11211, 11222))
df_Greenpoint$Neighborhood <- "GREENPOINT"
df_Bushwick_Williamsburg <- df_NYC %>% filter(Zip%in% c(11220, 11232))
df_Bushwick_Williamsburg$Neighborhood <- "BUSHWICK AND WILLIAMSBURG"
df_Sunset_Park <- df_NYC %>% filter(Zip%in% c(11206, 11221, 12237))
df_Sunset_Park$Neighborhood <- "SUNSET PARK"
df_Brooklyn <- rbind(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
df_Central_Harlem <- df_NYC %>% filter(Zip%in% c(10026, 10027, 10030, 10037, 10039))
df_Central_Harlem$Neighborhood <- "CENTRAL HARLEM"
df_Chelsea_Clinton <- df_NYC %>% filter(Zip%in% c(10001, 10011, 10018, 10019, 10020, 10036))
df_Chelsea_Clinton$Neighborhood <- "CHELSEA AND CLINTON"
df_East_Harlem <- df_NYC %>% filter(Zip%in% c(10029, 10035))
df_East_Harlem$Neighborhood <- "EAST HARLEM"
df_Gramercy_Park_Murray_Hill <- df_NYC %>% filter(Zip%in% c(10010, 10016, 10017, 10022))
df_Gramercy_Park_Murray_Hill$Neighborhood <- "GRAMERCY PARK AND MURRAY HILL"
df_Greenwich_Village_SoHo <- df_NYC %>% filter(Zip%in% c(10012, 10013, 10014))
df_Greenwich_Village_SoHo$Neighborhood <- "GREENWICH VILLAGE AND SOHO"
df_Lower_Manhattan <- df_NYC %>% filter(Zip%in% c(10004, 10005, 10006, 10007, 10038, 10280))
df_Lower_Manhattan$Neighborhood <- "LOWER MANHATTAN"
df_Lower_East <- df_NYC %>% filter(Zip%in% c(10002, 10003, 10009))
df_Lower_East_Side$Neighborhood <- "LOWER EAST SIDE"
df_Central_Harlem <- df_NYC %>% filter(Zip%in% c(10026, 10027, 10030, 10037, 10039))
df_Central_Harlem$Neighborhood <- "CENTRAL HARLEM"
df_Chelsea_Clinton <- df_NYC %>% filter(Zip%in% c(10001, 10011, 10018, 10019, 10020, 10036))
df_Chelsea_Clinton$Neighborhood <- "CHELSEA AND CLINTON"
df_East_Harlem <- df_NYC %>% filter(Zip%in% c(10029, 10035))
df_East_Harlem$Neighborhood <- "EAST HARLEM"
df_Gramercy_Park_Murray_Hill <- df_NYC %>% filter(Zip%in% c(10010, 10016, 10017, 10022))
df_Gramercy_Park_Murray_Hill$Neighborhood <- "GRAMERCY PARK AND MURRAY HILL"
df_Greenwich_Village_SoHo <- df_NYC %>% filter(Zip%in% c(10012, 10013, 10014))
df_Greenwich_Village_SoHo$Neighborhood <- "GREENWICH VILLAGE AND SOHO"
df_Lower_Manhattan <- df_NYC %>% filter(Zip%in% c(10004, 10005, 10006, 10007, 10038, 10280))
df_Lower_Manhattan$Neighborhood <- "LOWER MANHATTAN"
df_Lower_East <- df_NYC %>% filter(Zip%in% c(10002, 10003, 10009))
df_Lower_East$Neighborhood <- "LOWER EAST SIDE"
df_Upper_East <- df_NYC %>% filter(Zip%in% c(10021, 10028, 10044, 10065, 10075, 10128))
df_Upper_East$Neighborhood <- "UPPER EAST SIDE"
df_Upper_West <- df_NYC %>% filter(Zip%in% c(10023, 10024, 10025))
df_Upper_West$Neighborhood <- "UPPER WEST SIDE"
df_Inwood_Washington_Heights <- df_NYC %>% filter(Zip%in% c(10031, 10032, 10033, 10034, 10040))
df_Inwood_Washington_Heights$Neighborhood <- "INWOOD AND WASHINGTON HEIGHTS"
df_Manhattan <- rbind(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East , df_Upper_West , df_Inwood_Washington_Heights)
df_Northeast_Queens <- df_NYC %>% filter(Zip%in% c(11361, 11362, 11363, 11364))
df_Northeast_Queens$Neighborhood <- "NORTHEAST QUEENS"
df_North_Queens <- df_NYC %>% filter(Zip%in% c(11354, 11355, 11356, 11357, 11358, 11359, 11360))
df_North_Queens$Neighborhood <- "NORTH QUEENS"
df_Central_Queens <- df_NYC %>% filter(Zip%in% c(11365, 11366, 11367))
df_Central_Queens$Neighborhood <- "CENTRAL QUEENS"
df_Jamaica <- df_NYC %>% filter(Zip%in% c(11412, 11423, 11432, 11433, 11434, 11435, 11436))
df_Jamaica$Neighborhood <- "JAMAICA"
df_Northwest_Queens <- df_NYC %>% filter(Zip%in% c(11101, 11102, 11103, 11104, 11105, 11106))
df_Northwest_Queens$Neighborhood <- "NORTHWEST QUEENS"
df_West_Central_Queens <- df_NYC %>% filter(Zip%in% c(11374, 11375, 11379, 11385))
df_West_Central_Queens$Neighborhood <- "WEST CENTRAL QUEENS"
df_Rockaways <- df_NYC %>% filter(Zip%in% c(11691, 11692, 11693, 11694, 11695, 11697))
df_Rockaways$Neighborhood <- "ROCKAWAYS"
df_Southeast_Queens <- df_NYC %>% filter(Zip%in% c(11004, 11005, 11411, 11413, 11422, 11426, 11427, 11428, 11429))
df_Southeast_Queens$Neighborhood <- "SOUTHEAST QUEENS"
df_Southwest_Queens <- df_NYC %>% filter(Zip%in% c(11414, 11415, 11416, 11417, 11418, 11419, 11420, 11421))
df_Southwest_Queens$Neighborhood <- "SOUTHWEST QUEENS"
df_West_Queens <- df_NYC %>% filter(Zip%in% c(11368, 11369, 11370, 11372, 11373, 11377, 11378))
df_West_Queens$Neighborhood <- "WEST QUEENS"
df_Queens <- rbind(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
df_Port_Richmond <- df_NYC %>% filter(Zip%in% c(10302, 10303, 10310))
df_Port_Richmond$Neighborhood <- "PORT RICHMOND"
df_South_Shore <- df_NYC %>% filter(Zip%in% c(10306, 10307, 10308, 10309, 10312))
df_South_Shore$Neighborhood <- "SOUTH SHORE"
df_Stapleton_StGeorge <- df_NYC %>% filter(Zip%in% c(10301, 10304, 10305))
df_Stapleton_StGeorge$Neighborhood <- "STAPLETON AND ST. GEORGE"
df_MidIsland <- df_NYC %>% filter(Zip%in% c(10314))
df_MidIsland$Neighborhood <- "MID ISLAND"
df_Staten_Island <- rbind(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
df_NYC <- rbind(df_The_Bronx, df_Brooklyn, df_Manhattan, df_Queens, df_Staten_Island)
write.csv(df_NYC, "C:\\Users\\Admin\\Desktop\\df_NYC.csv", row.names=FALSE)
View(df_NYC)
View(df_NYC)
install.packages("gganimate")
install.packages("gapminder")
install.packages("ggthemes")
library("tidyverse")
library("ggplot2")
library("gganimate")
library("dplyr")
library("gapminder")
library("ggthemes")
calls <- read_csv("nyc_rodent_compliants.csv")
df_NYC <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%Y")) %>%
filter(Descriptor == "Rat Sighting") %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
df_NYC <- rename(df_NYC, Zip  = `Incident Zip` )
df_NYC <- df_NYC %>% filter(Zip %in% (10001:11697))
df_NYC <- separate(df_NYC, "Month_Year", c("Month","Year"), sep = "/")
df_NYC <- df_NYC[order(df_NYC$Year),]
write.csv(df_NYC, "C:\\Users\\Admin\\Desktop\\df_NYC.csv", row.names=FALSE)
# lots_year_1 <- df_NYC %>% filter(Year == "2020") %>% pull(BBL)
# lots_year_2 <- df_NYC %>% filter(Year == "2021") %>% pull(BBL)
# number_in_year_1 <- length(lots_year_1)
# number_in_year_2 <- length(lots_year_2)
# number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#
# number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# 50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# capture_recapture <- function(year) {
#   lots_year_1 <- df_NYC %>% filter(Year == year - 1) %>% pull(BBL)
#   lots_year_2 <- df_NYC %>% filter(Year == year) %>% pull(BBL)
#   number_in_year_1 <- length(lots_year_1)
#   number_in_year_2 <- length(lots_year_2)
#   number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#   50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# }
# qplot(x = factor(2011:2021),
#       weight = sapply(2011:2021, capture_recapture),
#       geom = "bar")  +
#   labs(x = "year",
#        y = "estimated rat population") +
#   theme_bw()
# library(ggplot2)
# ggplot(df_NYC, aes(fill= Borough, y = count , x = Year)) +
#   geom_bar(position = "stack", stat = "identity")
# lots_year_18 <- df_NYC %>% filter(Year == "18") %>% select(BBL, Borough, Zip)
# lots_year_19 <- df_NYC %>% filter(Year == "19") %>% select(BBL, Borough, Zip)
#
# common_lots_18_19 <- inner_join(lots_year_18, lots_year_19)
df_Central_Bronx <- df_NYC %>% filter(Zip%in% c(10453, 10457, 10460))
df_Central_Bronx$Neighborhood <- "CENTRAL BRONX"
df_Bronx_Park_Fordham <- df_NYC %>% filter(Zip%in% c(10458, 10467, 10468))
df_Bronx_Park_Fordham$Neighborhood <- "BRONX PARK AND FORDHAM"
df_High_Bridge_Morrisania <- df_NYC %>% filter(Zip%in% c(10451, 10452, 10456))
df_High_Bridge_Morrisania$Neighborhood <- "HIGH BRIDGE AND MORRISANIA"
df_Hunts_Point_Mott_Haven <- df_NYC %>% filter(Zip%in% c(10454, 10455, 10459, 10474))
df_Hunts_Point_Mott_Haven$Neighborhood <- "HUNTS POINT AND MOTT HAVEN"
df_Kingsbridge_Riverdale <- df_NYC %>% filter(Zip%in% c(10463, 10471))
df_Kingsbridge_Riverdale$Neighborhood <- "KINGSBRIDGE AND RIVERDALE"
df_Northeast_Bronx <- df_NYC %>% filter(Zip%in% c(10466, 10469, 10470, 10475))
df_Northeast_Bronx$Neighborhood <- "NORTHEAST BRONX"
df_Southeast_Bronx <- df_NYC %>% filter(Zip%in% c(10461, 10462, 10464, 10465, 10472, 10473))
df_Southeast_Bronx$Neighborhood <- "SOUTHEAST BRONX"
df_The_Bronx <- rbind(df_Central_Bronx, df_Bronx_Park_Fordham, df_High_Bridge_Morrisania, df_Hunts_Point_Mott_Haven, df_Kingsbridge_Riverdale, df_Northeast_Bronx, df_Southeast_Bronx)
df_Central_Brooklyn <- df_NYC %>% filter(Zip%in% c(11212, 11213, 11216, 11233, 11238))
df_Central_Brooklyn$Neighborhood <- "CENTRAL BROOKLYN"
df_Southwest_Brooklyn <- df_NYC %>% filter(Zip%in% c(11209, 11214, 11228))
df_Southwest_Brooklyn$Neighborhood <- "SOUTHWEST BROOKLYN"
df_Borough_Park <- df_NYC %>% filter(Zip%in% c(11204, 11218, 11219, 11230))
df_Borough_Park$Neighborhood <- "BOROUGH PARK"
df_Canarsie_Flatlands <- df_NYC %>% filter(Zip%in% c(11234, 11236, 11239))
df_Canarsie_Flatlands$Neighborhood <- "CANARSIE AND FLATLANDS"
df_Southern_Brooklyn <- df_NYC %>% filter(Zip%in% c(11223, 11224, 11229, 11235))
df_Southern_Brooklyn$Neighborhood <- "SOUTHERN BROOKLYN"
df_Northwest_Brooklyn <- df_NYC %>% filter(Zip%in% c(11201, 11205, 11215, 11217, 11231))
df_Northwest_Brooklyn$Neighborhood <- "NORTHWEST BROOKLYN"
df_Flatbush <- df_NYC %>% filter(Zip%in% c(11203, 11210, 11225, 11226))
df_Flatbush$Neighborhood <- "FLATBUSH"
df_East_NY_New_Lots <- df_NYC %>% filter(Zip%in% c(11207, 11208))
df_East_NY_New_Lots$Neighborhood <- "EAST NEW YORK AND NEW LOTS"
df_Greenpoint <- df_NYC %>% filter(Zip%in% c(11211, 11222))
df_Greenpoint$Neighborhood <- "GREENPOINT"
df_Bushwick_Williamsburg <- df_NYC %>% filter(Zip%in% c(11220, 11232))
df_Bushwick_Williamsburg$Neighborhood <- "BUSHWICK AND WILLIAMSBURG"
df_Sunset_Park <- df_NYC %>% filter(Zip%in% c(11206, 11221, 12237))
df_Sunset_Park$Neighborhood <- "SUNSET PARK"
df_Brooklyn <- rbind(df_Central_Brooklyn, df_Southwest_Brooklyn, df_Borough_Park, df_Canarsie_Flatlands, df_Southern_Brooklyn, df_Northwest_Brooklyn, df_Flatbush, df_East_NY_New_Lots, df_Greenpoint, df_Bushwick_Williamsburg, df_Sunset_Park)
df_Central_Harlem <- df_NYC %>% filter(Zip%in% c(10026, 10027, 10030, 10037, 10039))
df_Central_Harlem$Neighborhood <- "CENTRAL HARLEM"
df_Chelsea_Clinton <- df_NYC %>% filter(Zip%in% c(10001, 10011, 10018, 10019, 10020, 10036))
df_Chelsea_Clinton$Neighborhood <- "CHELSEA AND CLINTON"
df_East_Harlem <- df_NYC %>% filter(Zip%in% c(10029, 10035))
df_East_Harlem$Neighborhood <- "EAST HARLEM"
df_Gramercy_Park_Murray_Hill <- df_NYC %>% filter(Zip%in% c(10010, 10016, 10017, 10022))
df_Gramercy_Park_Murray_Hill$Neighborhood <- "GRAMERCY PARK AND MURRAY HILL"
df_Greenwich_Village_SoHo <- df_NYC %>% filter(Zip%in% c(10012, 10013, 10014))
df_Greenwich_Village_SoHo$Neighborhood <- "GREENWICH VILLAGE AND SOHO"
df_Lower_Manhattan <- df_NYC %>% filter(Zip%in% c(10004, 10005, 10006, 10007, 10038, 10280))
df_Lower_Manhattan$Neighborhood <- "LOWER MANHATTAN"
df_Lower_East <- df_NYC %>% filter(Zip%in% c(10002, 10003, 10009))
df_Lower_East$Neighborhood <- "LOWER EAST SIDE"
df_Upper_East <- df_NYC %>% filter(Zip%in% c(10021, 10028, 10044, 10065, 10075, 10128))
df_Upper_East$Neighborhood <- "UPPER EAST SIDE"
df_Upper_West <- df_NYC %>% filter(Zip%in% c(10023, 10024, 10025))
df_Upper_West$Neighborhood <- "UPPER WEST SIDE"
df_Inwood_Washington_Heights <- df_NYC %>% filter(Zip%in% c(10031, 10032, 10033, 10034, 10040))
df_Inwood_Washington_Heights$Neighborhood <- "INWOOD AND WASHINGTON HEIGHTS"
df_Manhattan <- rbind(df_Central_Harlem, df_Chelsea_Clinton, df_East_Harlem, df_Gramercy_Park_Murray_Hill, df_Greenwich_Village_SoHo, df_Lower_Manhattan, df_Lower_East, df_Upper_East , df_Upper_West , df_Inwood_Washington_Heights)
df_Northeast_Queens <- df_NYC %>% filter(Zip%in% c(11361, 11362, 11363, 11364))
df_Northeast_Queens$Neighborhood <- "NORTHEAST QUEENS"
df_North_Queens <- df_NYC %>% filter(Zip%in% c(11354, 11355, 11356, 11357, 11358, 11359, 11360))
df_North_Queens$Neighborhood <- "NORTH QUEENS"
df_Central_Queens <- df_NYC %>% filter(Zip%in% c(11365, 11366, 11367))
df_Central_Queens$Neighborhood <- "CENTRAL QUEENS"
df_Jamaica <- df_NYC %>% filter(Zip%in% c(11412, 11423, 11432, 11433, 11434, 11435, 11436))
df_Jamaica$Neighborhood <- "JAMAICA"
df_Northwest_Queens <- df_NYC %>% filter(Zip%in% c(11101, 11102, 11103, 11104, 11105, 11106))
df_Northwest_Queens$Neighborhood <- "NORTHWEST QUEENS"
df_West_Central_Queens <- df_NYC %>% filter(Zip%in% c(11374, 11375, 11379, 11385))
df_West_Central_Queens$Neighborhood <- "WEST CENTRAL QUEENS"
df_Rockaways <- df_NYC %>% filter(Zip%in% c(11691, 11692, 11693, 11694, 11695, 11697))
df_Rockaways$Neighborhood <- "ROCKAWAYS"
df_Southeast_Queens <- df_NYC %>% filter(Zip%in% c(11004, 11005, 11411, 11413, 11422, 11426, 11427, 11428, 11429))
df_Southeast_Queens$Neighborhood <- "SOUTHEAST QUEENS"
df_Southwest_Queens <- df_NYC %>% filter(Zip%in% c(11414, 11415, 11416, 11417, 11418, 11419, 11420, 11421))
df_Southwest_Queens$Neighborhood <- "SOUTHWEST QUEENS"
df_West_Queens <- df_NYC %>% filter(Zip%in% c(11368, 11369, 11370, 11372, 11373, 11377, 11378))
df_West_Queens$Neighborhood <- "WEST QUEENS"
df_Queens <- rbind(df_Northeast_Queens, df_North_Queens, df_Central_Queens, df_Jamaica, df_Northwest_Queens, df_West_Central_Queens, df_Rockaways, df_Southeast_Queens, df_Southwest_Queens, df_West_Queens)
df_Port_Richmond <- df_NYC %>% filter(Zip%in% c(10302, 10303, 10310))
df_Port_Richmond$Neighborhood <- "PORT RICHMOND"
df_South_Shore <- df_NYC %>% filter(Zip%in% c(10306, 10307, 10308, 10309, 10312))
df_South_Shore$Neighborhood <- "SOUTH SHORE"
df_Stapleton_StGeorge <- df_NYC %>% filter(Zip%in% c(10301, 10304, 10305))
df_Stapleton_StGeorge$Neighborhood <- "STAPLETON AND ST. GEORGE"
df_MidIsland <- df_NYC %>% filter(Zip%in% c(10314))
df_MidIsland$Neighborhood <- "MID ISLAND"
df_Staten_Island <- rbind(df_Port_Richmond, df_South_Shore, df_Stapleton_StGeorge, df_MidIsland)
df_NYC <- rbind(df_The_Bronx, df_Brooklyn, df_Manhattan, df_Queens, df_Staten_Island)
write.csv(df_NYC, "C:\\Users\\Admin\\Desktop\\df_NYC.csv", row.names=FALSE)
write.csv(df_The_Bronx, "C:\\Users\\Admin\\Desktop\\df_The_Bronx.csv", row.names=FALSE)
write.csv(df_Brooklyn, "C:\\Users\\Admin\\Desktop\\df_Brooklyn.csv", row.names=FALSE)
write.csv(df_Manhattan, "C:\\Users\\Admin\\Desktop\\df_Manhattan.csv", row.names=FALSE)
write.csv(df_Queens, "C:\\Users\\Admin\\Desktop\\df_Queens.csv", row.names=FALSE)
write.csv(df_Staten_Island, "C:\\Users\\Admin\\Desktop\\df_Staten_Island.csv", row.names=FALSE)
capture_recapture_the_bronx <- function(year) {
lots_year_1 <- df_The_Bronx %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_The_Bronx %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_The_Bronx_Num_Rats <- sapply(2011:2021, capture_recapture_the_bronx)
df_The_Bronx_Num_Rats <- as.data.frame(df_The_Bronx_Num_Rats)
df_The_Bronx_Num_Rats <- df_The_Bronx_Num_Rats %>%
add_column(Borough = "BRONX",
.after = "df_The_Bronx_Num_Rats")
df_The_Bronx_Num_Rats <- df_The_Bronx_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_The_Bronx_Num_Rats <- rename(df_The_Bronx_Num_Rats, numRats = df_The_Bronx_Num_Rats)
capture_recapture_brooklyn <- function(year) {
lots_year_1 <- df_Brooklyn %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Brooklyn %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Brooklyn_Num_Rats <- sapply(2011:2021, capture_recapture_brooklyn)
df_Brooklyn_Num_Rats <- as.data.frame(df_Brooklyn_Num_Rats)
df_Brooklyn_Num_Rats <- df_Brooklyn_Num_Rats %>%
add_column(Borough = "BROOKLYN",
.after = "df_Brooklyn_Num_Rats")
df_Brooklyn_Num_Rats <- df_Brooklyn_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Brooklyn_Num_Rats <- rename(df_Brooklyn_Num_Rats, numRats = df_Brooklyn_Num_Rats)
capture_recapture_manhattan <- function(year) {
lots_year_1 <- df_Manhattan %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Manhattan %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Manhattan_Num_Rats <- sapply(2011:2021, capture_recapture_manhattan)
df_Manhattan_Num_Rats <- as.data.frame(df_Manhattan_Num_Rats)
df_Manhattan_Num_Rats <- df_Manhattan_Num_Rats %>%
add_column(Borough = "MANHATTAN",
.after = "df_Manhattan_Num_Rats")
df_Manhattan_Num_Rats <- df_Manhattan_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Manhattan_Num_Rats <- rename(df_Manhattan_Num_Rats, numRats = df_Manhattan_Num_Rats)
capture_recapture_queens <- function(year) {
lots_year_1 <- df_Queens %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Queens %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Queens_Num_Rats <- sapply(2011:2021, capture_recapture_queens)
df_Queens_Num_Rats <- as.data.frame(df_Queens_Num_Rats)
df_Queens_Num_Rats <- df_Queens_Num_Rats %>%
add_column(Borough = "QUEENS",
.after = "df_Queens_Num_Rats")
df_Queens_Num_Rats <- df_Queens_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Queens_Num_Rats <- rename(df_Queens_Num_Rats, numRats = df_Queens_Num_Rats)
capture_recapture_staten_island <- function(year) {
lots_year_1 <- df_Staten_Island %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df_Staten_Island %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
df_Staten_Island_Num_Rats <- sapply(2011:2021, capture_recapture_staten_island)
df_Staten_Island_Num_Rats <- as.data.frame(df_Staten_Island_Num_Rats)
df_Staten_Island_Num_Rats <- df_Staten_Island_Num_Rats %>%
add_column(Borough = "STATEN ISLAND",
.after = "df_Staten_Island_Num_Rats")
df_Staten_Island_Num_Rats <- df_Staten_Island_Num_Rats %>%
add_column(Year = 2011:2021,
.after = "Borough")
df_Staten_Island_Num_Rats <- rename(df_Staten_Island_Num_Rats, numRats = df_Staten_Island_Num_Rats)
# capture_recapture_nyc <- function(year) {
#   lots_year_1 <- df_NYC %>% filter(Year == year - 1) %>% pull(BBL)
#   lots_year_2 <- df_NYC %>% filter(Year == year) %>% pull(BBL)
#   number_in_year_1 <- length(lots_year_1)
#   number_in_year_2 <- length(lots_year_2)
#   number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
#   50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
# }
#
# df_NYC_Num_Rats <- sapply(11:21, capture_recapture_nyc)
# df_NYC_Num_Rats <- as.data.frame(df_NYC_Num_Rats)
#
# df_NYC_Num_Rats <- df_NYC_Num_Rats %>%
#   add_column(Group = "NYC",
#              .after = "df_NYC_Num_Rats")
#
# df_NYC_Num_Rats <- df_NYC_Num_Rats %>%
#   add_column(Year = 11:21,
#              .after = "Group")
#
# df_NYC_Num_Rats <- rename(df_NYC_Num_Rats, numRats = df_NYC_Num_Rats)
options(scipen = 999)
df_NYC_Num_Rats <- list( df_Brooklyn_Num_Rats, df_Queens_Num_Rats,  df_Manhattan_Num_Rats, df_The_Bronx_Num_Rats, df_Staten_Island_Num_Rats)
df_NYC_Num_Rats <- Reduce(function(x,y) merge(x,y, all = TRUE), df_NYC_Num_Rats)
df_NYC_Num_Rats <- df_NYC_Num_Rats[order(df_NYC_Num_Rats$numRats),]
graph1.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Rat Population In Each Borough Over Time", subtitle = "Do rats proliferate faster in certain Boroughs?", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text())
ggsave("graph1.png", height = 1440, width = 2560, units = "px")
graph2.static <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text())
ggsave("graph2.png", height = 1440, width = 2560, units = "px")
graph1.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, color = Borough)) +
geom_line(size = 1.5) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,1500000, by = 100000)) +
labs (title = "Do Rats Proliferate Faster in Certain Boroughs?", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph1.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
View(graph2.static)
anim_save("graph1anim.gif")
graph2.anim <- ggplot(df_NYC_Num_Rats, aes(x = Year, y = numRats, fill = Borough)) +
geom_area(alpha=0.725) +
scale_x_continuous(breaks = seq(2011,2021, by = 1)) +
scale_y_continuous(breaks = seq(0,4000000, by = 250000)) +
labs (title = "Rat Population In NYC", subtitle = "Year: {frame_along}", x = "Year", y = "Population" ) +
theme_fivethirtyeight() +
theme(axis.title.y = element_text(), axis.title.x = element_text()) +
transition_reveal(Year) +
view_follow()
animate(graph2.anim, height = 720, width = 1280, fps = 30, duration = 15, end_pause = 90, res = 100)
anim_save("graph2anim.gif")
