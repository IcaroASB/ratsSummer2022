library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 22) %>%
select(Year, BBL, Borough) %>%
na.omit() %>%
group_by(BBL, Year, Borough ) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "10") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "11") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
qplot(x = factor(2011:2021),
weight = sapply(11:21, capture_recapture),
geom = "bar")  +
labs(x = "year",
y = "estimated rat population") +
theme_bw()
library(ggplot2)
ggplot(df, aes(fill= Borough, y = count , x = Year)) +
geom_bar(position = "stack", stat = "identity")
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
View(capture_recapture)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%y")) %>%
filter(Descriptor == "Rat Sighting",
Month_Year != 01/22, Month_Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
df = df %>%
mutate(Month_Year = ymd(Month_Year)) %>%
mutate_at(vars(date), funs(year, month))
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%y")) %>%
filter(Descriptor == "Rat Sighting",
Month_Year != 01/22, Month_Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%y")) %>%
filter(Descriptor == "Rat Sighting",
Month_Year != 01/22, Month_Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Month_Year = format(Date, "%m/%y")) %>%
filter(Descriptor == "Rat Sighting",
Month_Year != 01/22, Month_Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Month_Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "15") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
qplot(x = factor(2015:2021),
weight = sapply(15:21, capture_recapture),
geom = "bar")  +
labs(x = "year",
y = "estimated rat population") +
theme_bw()
library(ggplot2)
ggplot(df, aes(fill= Borough, y = count , x = Year)) +
geom_bar(position = "stack", stat = "identity")
lots_year_18 <- df %>% filter(Year == "18") %>% select(BBL, Borough, `Incident Zip`)
lots_year_19 <- df %>% filter(Year == "19") %>% select(BBL, Borough, `Incident Zip`)
common_lots_18_19 <- inner_join(lots_year_18, lots_year_19)
View(lots_year_18)
View(lots_year_19)
View(common_lots_18_19)
View(lots_year_18)
View(common_lots_18_19)
dfM <- filter(Borough == "Manhattan")
dfM <- df %>% filter(Borough == "Manhattan")
View(dfM)
View(lots_year_18)
dfM <- df %>% filter(Borough == "MANHATTAN")
dfManhattan <- df %>% filter(Borough == "MANHATTAN")
dfBronx <- df %>% filter(Borough == "BRONX")
dfBrooklyn <- df %>% filter(Borough == "BROOKLYN")
dfStatIsl <- df %>% filter(Borough == "STATEN ISLAND")
dfQueens <- df %>% filter(Borough == "Queens")
dfManhattan <- df %>% filter(Borough == "MANHATTAN")
dfBronx <- df %>% filter(Borough == "BRONX")
dfBrooklyn <- df %>% filter(Borough == "BROOKLYN")
dfStatIsl <- df %>% filter(Borough == "STATEN ISLAND")
dfQueens <- df %>% filter(Borough == "QUEENS")
dfManhattan <- df %>% filter(Borough == "MANHATTAN")
dfBronx <- df %>% filter(Borough == "BRONX")
dfBrooklyn <- df %>% filter(Borough == "BROOKLYN")
dfStatIsl <- df %>% filter(Borough == "STATEN ISLAND")
dfQueens <- df %>% filter(Borough == "QUEENS")
View(df)
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "15") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% filter (Month < 7) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
qplot(x = factor(2015:2021),
weight = sapply(15:21, capture_recapture),
geom = "bar")  +
labs(x = "year",
y = "estimated rat population") +
theme_bw()
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "15") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% filter (Month < 7) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
qplot(x = factor(2015:2021),
weight = sapply(15:21, capture_recapture),
geom = "bar")  +
labs(x = "year",
y = "estimated rat population") +
theme_bw()
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "15") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1 %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
library("tidyverse")
calls <- read_csv("nyc_rodent_compliants.csv")
# df <-
#   calls %>%
#   mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
#          Month_Year = format(Date, "%m/%y")) %>%
#   filter(Descriptor == "Rat Sighting",
#          Month_Year != 01/22, Month_Year >= 01/14) %>%
#   select( BBL, Borough, `Incident Zip`, Month_Year) %>%
#   na.omit() %>%
#   group_by(BBL, Borough, `Incident Zip`, Month_Year) %>%
#   summarize(count = n()) %>%
#   filter(BBL != 0, Borough > 10000)
df <-
calls %>%
mutate(Date = as.Date(`Created Date`, format = "%m/%d/%Y"),
Year = format(Date, "%y")) %>%
filter(Descriptor == "Rat Sighting",
Year != 01/22, Year >= 01/14) %>%
select( BBL, Borough, `Incident Zip`, Year) %>%
na.omit() %>%
group_by(BBL, Borough, `Incident Zip`, Year) %>%
summarize(count = n()) %>%
filter(BBL != 0, Borough > 10000)
lots_year_1 <- df %>% filter(Year == "14") %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == "15") %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
capture_recapture <- function(year) {
lots_year_1 <- df %>% filter(Year == year - 1) %>% pull(BBL)
lots_year_2 <- df %>% filter(Year == year) %>% pull(BBL)
number_in_year_1 <- length(lots_year_1)
number_in_year_2 <- length(lots_year_2)
number_in_year_1_and_2 <- sum(lots_year_1 %in% lots_year_2)
50 * number_in_year_1 * number_in_year_2 / number_in_year_1_and_2
}
qplot(x = factor(2015:2021),
weight = sapply(15:21, capture_recapture),
geom = "bar")  +
labs(x = "year",
y = "estimated rat population") +
theme_bw()
library(ggplot2)
ggplot(df, aes(fill= Borough, y = count , x = Year)) +
geom_bar(position = "stack", stat = "identity")
lots_year_18 <- df %>% filter(Year == "18") %>% select(BBL, Borough, `Incident Zip`)
lots_year_19 <- df %>% filter(Year == "19") %>% select(BBL, Borough, `Incident Zip`)
common_lots_18_19 <- inner_join(lots_year_18, lots_year_19)
dfManhattan <- df %>% filter(Borough == "MANHATTAN")
dfBronx <- df %>% filter(Borough == "BRONX")
dfBrooklyn <- df %>% filter(Borough == "BROOKLYN")
dfStatIsl <- df %>% filter(Borough == "STATEN ISLAND")
dfQueens <- df %>% filter(Borough == "QUEENS")
